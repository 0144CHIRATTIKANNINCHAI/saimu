<h1 class="pb-4">เลือกหมวดหมู่</h1>

<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/home">Home</a></li>
    <li class="breadcrumb-item"><a href="/categories">หมวดหมู่</a></li>
    <li class="breadcrumb-item active" aria-current="page">เลือกหมวดหมู่</li>
  </ol>
</nav>


<!-- สร้างแท็บสำหรับเลือกระหว่าง Temple และ Amulet -->
<div class="tab">
  <button class="tablinks active" onclick="openCity(event, 'temples')">Temples</button>
  <button class="tablinks" onclick="openCity(event, 'amulets')">Amulets</button>
</div>

<!-- สร้างคอนเทนต์ที่จะแสดงตามแท็บที่เลือก -->
<div id="temples" class="tabcontent" style="display: block;">
  <div class="row row-cols-2 row-cols-lg-5 g-2 g-lg-3">
    <% if (typeof categoryById !== 'undefined' && categoryById.length > 0) { %>
      <% categoryById.forEach(function(temple, index) { %>
        <% 
        function convertGoogleDriveLink(driveLink) {
            if (!driveLink) {
                return ''; // ถ้าไม่มีลิงก์ ส่งค่ากลับเป็นสตริงว่าง
            }
            const match = driveLink.match(/[-\w]{25,}/); // ดึง FILE_ID ออกจากลิงก์
            return match ? `https://drive.google.com/thumbnail?id=${match[0]}` : driveLink;
        }
        const convertedLink = convertGoogleDriveLink(temple.ภาพสถานที่);
        %>
        <a href="/temple/<%= temple._id %>" class="col text-center category__link">
          <div class="category__img category__img--large shadow">
            <img src="<%= convertedLink %>" alt="<%= temple.สถานที่ %>" loading="lazy">
          </div>
          <div class="pt-1"><%= temple.สถานที่ %></div>
        </a>
      <% }) %>
    <% } else { %>
      <p>No temples found.</p>
    <% } %>
  </div>
</div>

<div id="amulets" class="tabcontent" style="display: none;">
    <div class="row row-cols-2 row-cols-lg-5 g-2 g-lg-3">
      <% if (typeof categoryByIdamu !== 'undefined' && categoryByIdamu.length > 0) { %>
        <% categoryByIdamu.forEach(function(amulet, index) { %>
          <% 
          function convertGoogleDriveLink(driveLink) {
              if (!driveLink) {
                return ''; // ถ้าไม่มีลิงก์ ส่งค่ากลับเป็นสตริงว่าง
              }
              const match = driveLink.match(/[-\w]{25,}/); // ดึง FILE_ID ออกจากลิงก์
              return match ? `https://drive.google.com/thumbnail?id=${match[0]}` : driveLink;
          }
          const convertedLinkamu = convertGoogleDriveLink(amulet.ภาพ);
          %>
          <a href="/amulet/<%= amulet._id %>" class="col text-center category__link">
            <div class="category__img category__img--large shadow">
              <img src="<%= convertedLinkamu %>" alt="<%= amulet.ชื่อเครื่องราง %>" loading="lazy">
            </div>
            <div class="pt-1"><%= amulet.ชื่อเครื่องราง %></div>
          </a>
        <% }) %>
      <% } else { %>
        <p>No amulets found.</p>
      <% } %>
    </div>
  </div>
  

<script>
function openCity(evt, cityName) {
  var i, tabcontent, tablinks;
  
  // ซ่อนคอนเทนต์ของทุกแท็บ
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  
  // ลบ active class จากทุกแท็บ
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }

  // แสดงคอนเทนต์ของแท็บที่คลิก
  document.getElementById(cityName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>
